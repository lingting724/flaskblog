# Flask博客系统项目规范

## 项目概述
这是一个使用Flask为核心技术开发的前后端不分离的开源博客系统，涵盖美观的后台管理界面和前台展示界面，最终通过Docker Compose自动化构建镜像的方式发布，供他人一键部署。

## 核心功能模块
1. **用户管理**：注册、登录、个人资料管理、权限控制、关注系统
2. **博客文章管理**：创建、编辑、删除、发布文章、搜索文章、热门文章、相关文章、文章收藏、文章浏览量统计
3. **分类管理**：创建、编辑、删除分类
4. **标签管理**：创建、编辑、删除标签
5. **评论管理**：发表评论、评论审核、评论删除

## 项目结构 
flask-blog/
├── app/ # 应用主目录
│ ├── init.py # 应用初始化
│ ├── models/ # 数据模型
│ ├── controllers/ # 控制器
│ ├── static/ # 静态文件(CSS, JS, 图片)
│ ├── templates/ # 模板文件
│ │ ├── admin/ # 后台管理模板
│ │ └── front/ # 前台展示模板
│ ├── forms/ # 表单验证
│ └── utils/ # 工具函数
├── config.py # 配置文件
├── requirements.txt # 依赖包
├── run.py # 启动脚本
├── .env # 环境变量
├── migrations/ # 数据库迁移文件
├── tests/ # 测试代码
├── Dockerfile # Docker配置
└── docker-compose.yml # Docker Compose配置


## 技术栈
1. **后端**：
   - Flask：核心框架
   - Flask-SQLAlchemy：ORM
   - Flask-Migrate：数据库迁移
   - Flask-Login：用户认证
   - Flask-WTF：表单处理
   - Flask-Admin：后台管理界面
   - Flask-RESTful：API构建(可选)

2. **前端**：
   - Bootstrap 5：响应式UI
   - jQuery：DOM操作
   - Summernote/TinyMCE：富文本编辑器
   - Font Awesome：图标

3. **数据库**：
   - SQLite：主数据库（轻量级文件数据库）
   - Redis：缓存和会话存储

4. **部署**：
   - Docker & Docker Compose
   - Nginx：反向代理
   - Gunicorn：WSGI服务器

## 编码规范
1. 使用PEP 8风格指南
2. 类名使用驼峰命名法(CamelCase)
3. 函数和变量使用小写下划线命名法(snake_case)
4. 模块名使用小写字母
5. 常量使用大写字母
6. 每个函数和类都应有文档字符串
7. 使用类型注解提高代码可读性

## 项目进度追踪

### 已完成功能
- [x] 项目基础结构搭建
- [x] 数据库模型设计与实现
  - [x] 用户模型(User)
  - [x] 文章模型(Post)
  - [x] 分类模型(Category)
  - [x] 标签模型(Tag)
  - [x] 评论模型(Comment)
- [x] 控制器实现
  - [x] 认证控制器(auth.py)
  - [x] 博客控制器(blog.py)
  - [x] 用户控制器(user.py)
  - [x] 管理员控制器(admin.py)
  - [x] 错误处理控制器(errors.py)
- [x] 表单实现
  - [x] 认证表单(auth.py)
  - [x] 博客表单(blog.py)
  - [x] 管理员表单(admin.py)
  - [x] 用户表单(user.py)
- [x] Docker配置
  - [x] Dockerfile
  - [x] docker-compose.yml

## 注意事项
1. 每次完成功能，将已实现的目标写入本文件，以便追踪项目进度
2. 代码提交前进行自测，确保功能正常
3. 定期进行代码审查，保证代码质量
4. 保持良好的代码注释和文档更新
5. 每次在编写或修改代码之前，仔细阅读项目代码，不要遗漏要修改的地方

# Flask博客系统项目进度

## 已完成功能

### 1. 用户系统
- [x] 用户注册
- [x] 用户登录
- [x] 用户退出
- [x] 个人资料管理
  - [x] 修改基本信息
  - [x] 更换头像
  - [x] 修改密码
- [x] 标签管理
  - [x] 用户只能看到自己创建的标签
  - [x] 创建标签时自动关联当前用户
  - [x] 创建标签时检查是否与用户已有标签重名
  - [x] 只能删除自己创建的标签
  - [x] 标签下有文章时禁止删除
  - [x] 创建和删除操作有完整的错误处理
- [x] 密码重置功能
- [x] 用户关注/取消关注
- [x] 查看关注者和粉丝列表
- [x] 用户头像支持(本地上传和Gravatar)
- [x] 用户公开主页
- [x] 用户通知系统

### 2. 博客文章
- [x] 文章的 CRUD 操作
- [x] 文章分类
- [x] 文章标签
- [x] 文章封面图片上传
- [x] 文章摘要
- [x] 文章浏览量统计
- [x] 文章发布/草稿状态
- [x] 文章收藏功能
- [x] 文章搜索功能
- [x] 相关文章推荐
- [x] 文章分页显示
- [x] 热门文章列表
- [x] 文章分类和标签云

### 3. 评论系统
- [x] 发表评论
- [x] 评论审核
- [x] 评论管理
- [x] 评论删除功能
- [x] 评论时间显示
- [x] 评论者头像显示
- [x] 评论通知功能

### 4. 后台管理
- [x] 仪表盘统计
- [x] 文章管理
- [x] 分类管理
- [x] 标签管理
  - [x] 查看所有标签
  - [x] 编辑任意标签
  - [x] 删除标签（有文章时禁止删除）
  - [x] 批量操作标签
- [x] 用户管理
- [x] 评论管理

### 5. 其他功能
- [x] 分页
- [x] 响应式界面
- [x] 邮件通知系统
- [x] 用户设置功能
- [x] 错误页面处理(404/403/500)
- [x] 数据库迁移支持
- [x] Docker部署支持

### 6. 技术实现
- [x] Flask-SQLAlchemy ORM
- [x] Flask-Login 用户认证
- [x] Flask-WTF 表单处理
- [x] Flask-Mail 邮件发送
- [x] Flask-Moment 时间本地化
- [x] Bootstrap 5 响应式布局
- [x] Font Awesome 图标支持
- [x] SQLite 数据库
- [x] Jinja2 模板引擎
- [x] 文件上传和处理
- [x] 数据库关系设计

# Docker 镜像构建与部署规范

## 项目目标
提供一个基于 Flask 的开源博客系统，实现一键部署功能，降低用户使用门槛。

## 核心文件说明

### 1. Dockerfile
- 基于 python:3.9-slim 镜像
- 工作目录设置为 /myblog
- 分层构建以优化镜像大小
- 包含必要的目录创建和权限设置

### 2. docker-compose.yml
- 定义完整的服务栈：web、redis、nginx
- 使用数据卷持久化数据
- 环境变量配置
- 服务依赖关系管理

### 3. docker-entrypoint.sh
- 容器启动时的初始化脚本
- 数据库迁移
- 自动创建管理员账号
- 启动应用服务

### 4. nginx.conf
- 反向代理配置
- 静态文件处理
- 上传文件目录配置

## 部署流程

### 1. 基础环境要求
- Docker Engine
- Docker Compose
- 互联网连接

### 2. 一键部署步骤
```bash
# 克隆项目
git clone https://github.com/your-username/flask-blog.git
cd flask-blog

# 启动服务
docker-compose up -d
```

### 3. 初始化命令
```bash
# 创建管理员账号
docker-compose exec web flask create-admin --auto

# 生成测试数据（可选）
docker-compose exec web flask init-data
```

## 数据持久化
- myblog-data：数据库文件
- myblog-uploads：上传的文件
- redis-data：Redis 数据

## 维护命令
```bash
# 查看日志
docker-compose logs -f

# 重启服务
docker-compose restart

# 停止服务
docker-compose down

# 清理数据（慎用）
docker-compose down -v
```

## 注意事项
1. 首次部署需要等待数据库初始化完成
2. 建议定期备份数据卷
3. 生产环境部署时注意修改密钥和邮箱配置
4. 建议使用 HTTPS 进行安全访问

## 贡献指南
1. 代码提交前进行本地测试
2. 遵循项目的代码规范
3. 编写清晰的提交信息
4. 更新相关文档

## 未来规划
1. 支持自定义主题
2. 添加更多部署选项
3. 优化性能和安全性
4. 提供更多数据库选择

# Flask博客系统功能模块

## 一、前台展示系统

### 1. 个人中心
- [x] 个人资料管理
  - [x] 修改基本信息
  - [x] 更换头像
  - [x] 修改密码
- [x] 个人主页
  - [x] 展示个人信息
  - [x] 展示发布的文章
  - [x] 展示收藏的文章
- [x] 个人设置
  - [x] 邮件通知设置
  - [x] 隐私设置

### 2. 内容管理
- [x] 文章管理
  - [x] 创建文章
  - [x] 编辑文章
  - [x] 删除文章
  - [x] 文章发布/草稿状态
- [x] 分类管理
  - [x] 创建个人分类
  - [x] 删除个人分类
  - [x] 分类下有文章时禁止删除
- [x] 标签管理
  - [x] 创建个人标签
  - [x] 删除个人标签
  - [x] 标签下有文章时禁止删除

### 3. 社交互动
- [x] 关注系统
  - [x] 关注/取消关注用户
  - [x] 查看关注列表
  - [x] 查看粉丝列表
- [x] 评论系统
  - [x] 发表评论
  - [x] 回复评论
  - [x] 删除自己的评论
- [x] 收藏系统
  - [x] 收藏/取消收藏文章
  - [x] 管理收藏列表

### 4. 通知中心
- [x] 消息通知
  - [x] 新增关注通知
  - [x] 新增评论通知
  - [x] 评论回复通知
- [x] 通知管理
  - [x] 标记已读
  - [x] 全部标记已读
  - [x] 筛选未读/已读通知

### 5. 内容浏览
- [x] 文章浏览
  - [x] 查看文章详情
  - [x] 文章分类浏览
  - [x] 文章标签筛选
  - [x] 热门文章推荐
- [x] 搜索功能
  - [x] 文章搜索
  - [x] 用户搜索
  - [x] 标签搜索

### 6. 数据统计
- [x] 个人仪表盘
  - [x] 文章数量统计
  - [x] 评论数量统计
  - [x] 文章浏览量统计
  - [x] 最近发布文章
  - [x] 最近评论

## 二、后台管理系统

### 4. 后台管理
- [x] 仪表盘统计
- [x] 文章管理
- [x] 分类管理
- [x] 标签管理
  - [x] 查看所有标签
  - [x] 编辑任意标签
  - [x] 删除标签（有文章时禁止删除）
- [x] 用户管理
- [x] 评论管理